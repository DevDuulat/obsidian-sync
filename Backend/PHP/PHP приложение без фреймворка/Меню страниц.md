### Меню страниц

Теперь у нас есть динамические страницы, но их сложно найти. В этом разделе мы создадим меню с ссылками на все страницы.

### Зачем использовать шаблоны?

Вместо того чтобы дублировать код для меню в каждом шаблоне, мы можем использовать механизм расширения шаблонов. Это упростит поддержку и позволит избежать дублирования кода.

### Переход на Twig

Установите Twig с помощью Composer:

```bash
composer require "twig/twig:~1.0"
```

Создайте файл `TwigRenderer.php` в папке `src/Template`:

```php
<?php declare(strict_types = 1);

namespace Example\Template;

use Twig_Environment;

class TwigRenderer implements Renderer
{
    private $renderer;

    public function __construct(Twig_Environment $renderer)
    {
        $this->renderer = $renderer;
    }

    public function render($template, $data = []) : string
    {
        return $this->renderer->render("$template.html", $data);
    }
}
```

### Настройка зависимостей

Добавьте следующую конфигурацию в `Dependencies.php`:

```php
$injector->delegate('Twig_Environment', function () use ($injector) {
    $loader = new Twig_Loader_Filesystem(dirname(__DIR__) . '/templates');
    $twig = new Twig_Environment($loader);
    return $twig;
});
```

Замените alias для `Renderer` на `TwigRenderer` в зависимости от внедрения.

### Создание меню

В контроллере `Homepage` измените массив `$data`:

```php
$data = [
    'name' => $this->request->getParameter('name', 'stranger'),
    'menuItems' => [['href' => '/', 'text' => 'Homepage']],
];
```

В `Homepage.html` добавьте:

```twig
{% for item in menuItems %}
    <a href="{{ item.href }}">{{ item.text }}</a><br>
{% endfor %}
```

### Создание общего шаблона Layout

Создайте файл `Layout.html` в папке `templates`:

```twig
{% for item in menuItems %}
    <a href="{{ item['href'] }}">{{ item['text'] }}</a><br>
{% endfor %}
<hr>
{% block content %}
{% endblock %}
```

Измените `Homepage.html` и `Page.html` для использования нового шаблона:

#### Homepage.html

```twig
{% extends "Layout.html" %}
{% block content %}
    <h1>Hello World</h1>
    Hello {{ name }}
{% endblock %}
```

#### Page.html

```twig
{% extends "Layout.html" %}
{% block content %}
    {{ content }}
{% endblock %}
```

### Общий доступ к меню

Сейчас меню определяется только в `Homepage`, поэтому давайте создадим интерфейс для читателя меню.

Создайте новый интерфейс `MenuReader.php` в папке `src/Menu`:

```php
<?php declare(strict_types = 1);

namespace Example\Menu;

interface MenuReader
{
    public function readMenu() : array;
}
```

### Реализация MenuReader

Создайте `ArrayMenuReader.php`:

```php
<?php declare(strict_types = 1);

namespace Example\Menu;

class ArrayMenuReader implements MenuReader
{
    public function readMenu() : array
    {
        return [
            ['href' => '/', 'text' => 'Homepage'],
        ];
    }
}
```

### Настройка зависимостей для MenuReader

Добавьте следующие строки в `Dependencies.php`:

```php
$injector->alias('Example\Menu\MenuReader', 'Example\Menu\ArrayMenuReader');
$injector->share('Example\Menu\ArrayMenuReader');
```

### Обновление FrontendTwigRenderer

Обновите `FrontendTwigRenderer.php`, чтобы использовать `MenuReader`:

```php
<?php declare(strict_types = 1);

namespace Example\Template;

use Example\Menu\MenuReader;

class FrontendTwigRenderer implements FrontendRenderer
{
    private $renderer;
    private $menuReader;

    public function __construct(Renderer $renderer, MenuReader $menuReader)
    {
        $this->renderer = $renderer;
        $this->menuReader = $menuReader;
    }

    public function render($template, $data = []) : string
    {
        $data = array_merge($data, [
            'menuItems' => $this->menuReader->readMenu(),
        ]);
        return $this->renderer->render($template, $data);
    }
}
```

### Итог

Теперь у вас есть меню, доступное на всех страницах. Проверьте, чтобы все работало, и не забудьте закоммитить изменения!